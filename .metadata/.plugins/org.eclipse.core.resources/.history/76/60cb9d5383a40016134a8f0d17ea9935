var mongo = require('./mongo');

function search(msg,callback)
{
	var search_txt = msg.search_txt;
	var search_category = msg.search_category;
	var res,query;

	if(search_category != "All Categories")
		query = {"name":"//+search_txt+//"};
	else
		query = {"name":"//+search_txt+//","category":search_category};
	
	var col = mongo.collection('item');
	col.find(query,function(error,result)
	{
		if(result)
		{
			res.code = "200",
			res.value = result;
		}	
		else
		{
			console.log("returned false");
			res.code = "401";
		}	
		callback(null, res);
	});
}

function getCartNumber(msg,callback)
{
	var res={};
	
	var col = mongo.collection('user');
	col.find({""},function(error,result)
	{
		if(result)
		{
			res.code = "200",
			res.value = result;
		}	
		else
		{
			console.log("returned false");
			res.code = "401";
		}	
		callback(null, res);
	});
}

exports.getLoginSessionValues = getLoginSessionValues;
exports.logout = logout;
exports.search = search;
exports.getSearchPage = getSearchPage;
exports.getSearchSession = getSearchSession;
exports.getCartNumber = getCartNumber;